<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.wequan.bu.repository.dao.TutorMapper">
  <resultMap id="BaseResultMap" type="com.wequan.bu.repository.model.Tutor">
    <id column="id" jdbcType="INTEGER" property="id" />
    <association property="user" column="{id=user_id}" select="com.wequan.bu.repository.dao.UserMapper.selectByPrimaryKey"/>
  </resultMap>
  <resultMap id="TutorMapper" type="com.wequan.bu.repository.model.Tutor">
    <id column="professor_id" jdbcType="INTEGER" property="id"/>
    <result column="brief_introduction" jdbcType="VARCHAR" property="briefIntroduction"/>
    <result column="resume_path" jdbcType="VARCHAR" property="resumePath"/>
    <result column="transcript_path" jdbcType="VARCHAR" property="transcriptPath"/>
    <result column="other_proof_path" jdbcType="VARCHAR" property="otherProofPath"/>
    <result column="create_time" jdbcType="TIMESTAMP" property="createTime"/>
  </resultMap>

  <select id="selectAll" resultMap="BaseResultMap">
    select *
    from ${schema}.wq_tutor_profile
  </select>

  <select id="selectByConditions" resultMap="BaseResultMap">
    select * from ${schema}.wq_tutor_profile
    <if test="where != null and where != ''">
      where ${where}
    </if>
    <if test="orderBy != null and orderBy != ''">
      order by ${orderBy}
    </if>
  </select>

   <select id="selectTutors" resultMap="BaseResultMap">
    SELECT *
    FROM ${schema}.wq_tutor_profile p
    <if test="subject_id != null">
        LEFT JOIN ${schema}.wq_tutor_subject s on p.id = s.tutor_id
        WHERE s.subject_id = #{subject_id}
    </if>
    ORDER BY create_time DESC
   </select>

</mapper>